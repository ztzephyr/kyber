#include <stddef.h>
#include <stdio.h>
#include <string.h>
#include "kem.h"
#include "randombytes.h"
#include "polyvec.h"

#define NTESTS 1000



int16_t gTestVecNttK2Input[2][256] = {
    {(int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0x0003, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff,
     (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0002, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001,
     (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0003, (int16_t)0x0001, (int16_t)0x0001,
     (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0002, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0002,
     (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff,
     (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000,
     (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff,
     (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001,
     (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff,
     (int16_t)0x0002, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0003, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000,
     (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0xffff,
     (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000,
     (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0000,
     (int16_t)0x0001, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0003, (int16_t)0xffff,
     (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0002, (int16_t)0xffff,
     (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001,
     (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0xffff,
     (int16_t)0x0002},
    {(int16_t)0x0002, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001,
     (int16_t)0x0002, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff,
     (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0002,
     (int16_t)0x0001, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0x0001,
     (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff,
     (int16_t)0x0001, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0002, (int16_t)0x0000,
     (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0003, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0x0003, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0001,
     (int16_t)0x0002, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0000,
     (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000,
     (int16_t)0x0003, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0x0001,
     (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000,
     (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001,
     (int16_t)0x0000, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0002, (int16_t)0x0002, (int16_t)0xffff, (int16_t)0x0000,
     (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0002, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0002, (int16_t)0x0001,
     (int16_t)0x0000, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0002, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000,
     (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0003, (int16_t)0x0000,
     (int16_t)0xffff, (int16_t)0x0000, (int16_t)0xffff, (int16_t)0x0001, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0002, (int16_t)0xffff, (int16_t)0xffff, (int16_t)0x0000, (int16_t)0x0000, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0001, (int16_t)0x0001,
     (int16_t)0x0000}

};
int16_t gTestVecNttK2Ref[2][256] = {
    {(int16_t)0x0c2a, (int16_t)0x0a30, (int16_t)0x0caa, (int16_t)0x05b8, (int16_t)0x0421, (int16_t)0x0262, (int16_t)0x06e4, (int16_t)0x06c0, (int16_t)0x05bf, (int16_t)0x0c58, (int16_t)0x0740, (int16_t)0x0731, (int16_t)0x0524, (int16_t)0x09c5, (int16_t)0x00b5,
     (int16_t)0x065e, (int16_t)0x0aa3, (int16_t)0x0a51, (int16_t)0x06da, (int16_t)0x094a, (int16_t)0x0548, (int16_t)0x046b, (int16_t)0x049b, (int16_t)0x0582, (int16_t)0x0c7d, (int16_t)0x0c26, (int16_t)0x03a0, (int16_t)0x0ab5, (int16_t)0x05fd, (int16_t)0x0884,
     (int16_t)0x05aa, (int16_t)0x0786, (int16_t)0x0994, (int16_t)0x02c5, (int16_t)0x0a21, (int16_t)0x088a, (int16_t)0x0cc3, (int16_t)0x0b7f, (int16_t)0x0afc, (int16_t)0x07f1, (int16_t)0x0250, (int16_t)0x0a73, (int16_t)0x0b86, (int16_t)0x012c, (int16_t)0x081e,
     (int16_t)0x0b63, (int16_t)0x008e, (int16_t)0x009c, (int16_t)0x056e, (int16_t)0x03f2, (int16_t)0x0a3c, (int16_t)0x094a, (int16_t)0x0acc, (int16_t)0x0846, (int16_t)0x0718, (int16_t)0x0a56, (int16_t)0x0782, (int16_t)0x074a, (int16_t)0x0b94, (int16_t)0x0acd,
     (int16_t)0x0bd9, (int16_t)0x08a7, (int16_t)0x06dc, (int16_t)0x0296, (int16_t)0x049e, (int16_t)0x0445, (int16_t)0x0b4a, (int16_t)0x0422, (int16_t)0x0303, (int16_t)0x0420, (int16_t)0x059a, (int16_t)0x050a, (int16_t)0x0922, (int16_t)0x061c, (int16_t)0x09f0,
     (int16_t)0x053d, (int16_t)0x06d9, (int16_t)0x07c9, (int16_t)0x03db, (int16_t)0x0979, (int16_t)0x03e6, (int16_t)0x0196, (int16_t)0x0556, (int16_t)0x092e, (int16_t)0x0659, (int16_t)0x04e1, (int16_t)0x0c66, (int16_t)0x0ce6, (int16_t)0x007d, (int16_t)0x0b94,
     (int16_t)0x0280, (int16_t)0x0977, (int16_t)0x0537, (int16_t)0x0405, (int16_t)0x018f, (int16_t)0x030f, (int16_t)0x093d, (int16_t)0x0ad2, (int16_t)0x07d7, (int16_t)0x00d7, (int16_t)0x0c6b, (int16_t)0x0c46, (int16_t)0x0702, (int16_t)0x0649, (int16_t)0x068a,
     (int16_t)0x0c16, (int16_t)0x02e7, (int16_t)0x053e, (int16_t)0x06cf, (int16_t)0x031d, (int16_t)0x0b43, (int16_t)0x0aa0, (int16_t)0x004a, (int16_t)0x01d7, (int16_t)0x0388, (int16_t)0x0bb0, (int16_t)0x0483, (int16_t)0x0834, (int16_t)0x09eb, (int16_t)0x08b1,
     (int16_t)0x06ea, (int16_t)0x0ae0, (int16_t)0x0aea, (int16_t)0x04c9, (int16_t)0x0764, (int16_t)0x0198, (int16_t)0x059b, (int16_t)0x0bac, (int16_t)0x05dc, (int16_t)0x0263, (int16_t)0x0271, (int16_t)0x0822, (int16_t)0x01ed, (int16_t)0x073b, (int16_t)0x08b0,
     (int16_t)0x0307, (int16_t)0x06dc, (int16_t)0x0bd2, (int16_t)0x0679, (int16_t)0x0616, (int16_t)0x07bc, (int16_t)0x07d6, (int16_t)0x0473, (int16_t)0x0aed, (int16_t)0x0572, (int16_t)0x057a, (int16_t)0x035e, (int16_t)0x089e, (int16_t)0x0abd, (int16_t)0x0ce2,
     (int16_t)0x0605, (int16_t)0x0165, (int16_t)0x0951, (int16_t)0x09f9, (int16_t)0x02e9, (int16_t)0x06c3, (int16_t)0x0991, (int16_t)0x0a10, (int16_t)0x0a72, (int16_t)0x00e6, (int16_t)0x05a3, (int16_t)0x04b3, (int16_t)0x06ac, (int16_t)0x0796, (int16_t)0x034a,
     (int16_t)0x087f, (int16_t)0x09ff, (int16_t)0x07e0, (int16_t)0x0337, (int16_t)0x016b, (int16_t)0x09d0, (int16_t)0x0c67, (int16_t)0x0cf2, (int16_t)0x0892, (int16_t)0x0832, (int16_t)0x0b0b, (int16_t)0x032f, (int16_t)0x0053, (int16_t)0x000d, (int16_t)0x0c02,
     (int16_t)0x0037, (int16_t)0x0497, (int16_t)0x0656, (int16_t)0x0ce3, (int16_t)0x05e8, (int16_t)0x057a, (int16_t)0x06ad, (int16_t)0x01ed, (int16_t)0x0245, (int16_t)0x007a, (int16_t)0x0102, (int16_t)0x0a2e, (int16_t)0x0ae0, (int16_t)0x0854, (int16_t)0x0843,
     (int16_t)0x0af3, (int16_t)0x045f, (int16_t)0x047c, (int16_t)0x048b, (int16_t)0x072e, (int16_t)0x0971, (int16_t)0x09cc, (int16_t)0x0724, (int16_t)0x09fd, (int16_t)0x084a, (int16_t)0x0a53, (int16_t)0x0860, (int16_t)0x08b4, (int16_t)0x0c62, (int16_t)0x0a04,
     (int16_t)0x09ec, (int16_t)0x0915, (int16_t)0x01b1, (int16_t)0x0b34, (int16_t)0x01e6, (int16_t)0x0412, (int16_t)0x0ac7, (int16_t)0x0453, (int16_t)0x057f, (int16_t)0x063f, (int16_t)0x0359, (int16_t)0x0c72, (int16_t)0x03c7, (int16_t)0x052e, (int16_t)0x0c2d,
     (int16_t)0x093b, (int16_t)0x057a, (int16_t)0x0bfe, (int16_t)0x02e9, (int16_t)0x0c26, (int16_t)0x0197, (int16_t)0x0c6c, (int16_t)0x06fe, (int16_t)0x0bbd, (int16_t)0x0a1c, (int16_t)0x07b4, (int16_t)0x0266, (int16_t)0x0aed, (int16_t)0x01fa, (int16_t)0x0b27,
     (int16_t)0x0772, (int16_t)0x045e, (int16_t)0x0859, (int16_t)0x01e3, (int16_t)0x0a04, (int16_t)0x06df, (int16_t)0x0179, (int16_t)0x0435, (int16_t)0x07ab, (int16_t)0x0896, (int16_t)0x03c0, (int16_t)0x0846, (int16_t)0x02b6, (int16_t)0x02ad, (int16_t)0x0a37,
     (int16_t)0x012d},
    {(int16_t)0x03c2, (int16_t)0x0cea, (int16_t)0x0a92, (int16_t)0x009e, (int16_t)0x05b7, (int16_t)0x0a00, (int16_t)0x01ef, (int16_t)0x0376, (int16_t)0x089b, (int16_t)0x0a19, (int16_t)0x0c71, (int16_t)0x0714, (int16_t)0x04fb, (int16_t)0x04f0, (int16_t)0x0734,
     (int16_t)0x0cc2, (int16_t)0x0120, (int16_t)0x00c1, (int16_t)0x0242, (int16_t)0x0071, (int16_t)0x0ca0, (int16_t)0x0b35, (int16_t)0x046a, (int16_t)0x047a, (int16_t)0x067c, (int16_t)0x0738, (int16_t)0x042d, (int16_t)0x09b9, (int16_t)0x0c64, (int16_t)0x0bcc,
     (int16_t)0x048f, (int16_t)0x0108, (int16_t)0x0889, (int16_t)0x078c, (int16_t)0x0c49, (int16_t)0x0471, (int16_t)0x0a94, (int16_t)0x0c60, (int16_t)0x091a, (int16_t)0x0205, (int16_t)0x03eb, (int16_t)0x0ca2, (int16_t)0x0c82, (int16_t)0x08f3, (int16_t)0x0345,
     (int16_t)0x02e3, (int16_t)0x0743, (int16_t)0x0bf1, (int16_t)0x06f0, (int16_t)0x0141, (int16_t)0x0571, (int16_t)0x0c24, (int16_t)0x0b99, (int16_t)0x04ed, (int16_t)0x0a8c, (int16_t)0x071e, (int16_t)0x00d0, (int16_t)0x0850, (int16_t)0x010f, (int16_t)0x03f1,
     (int16_t)0x0012, (int16_t)0x042e, (int16_t)0x099f, (int16_t)0x06d5, (int16_t)0x0bf9, (int16_t)0x04ac, (int16_t)0x03ba, (int16_t)0x0292, (int16_t)0x02ca, (int16_t)0x073e, (int16_t)0x0c4b, (int16_t)0x04c3, (int16_t)0x060b, (int16_t)0x0432, (int16_t)0x01f7,
     (int16_t)0x02f6, (int16_t)0x0b47, (int16_t)0x0c03, (int16_t)0x0106, (int16_t)0x0999, (int16_t)0x00e1, (int16_t)0x08cf, (int16_t)0x0cb0, (int16_t)0x02e3, (int16_t)0x09b8, (int16_t)0x06de, (int16_t)0x0692, (int16_t)0x030e, (int16_t)0x0959, (int16_t)0x0be0,
     (int16_t)0x0c11, (int16_t)0x0b2a, (int16_t)0x099c, (int16_t)0x09d3, (int16_t)0x084b, (int16_t)0x0b4f, (int16_t)0x0c8f, (int16_t)0x0c45, (int16_t)0x097e, (int16_t)0x0738, (int16_t)0x04b5, (int16_t)0x0541, (int16_t)0x0ae6, (int16_t)0x0a57, (int16_t)0x0357,
     (int16_t)0x0598, (int16_t)0x09ff, (int16_t)0x0321, (int16_t)0x0b5e, (int16_t)0x074f, (int16_t)0x0893, (int16_t)0x02a3, (int16_t)0x0641, (int16_t)0x05b6, (int16_t)0x01a1, (int16_t)0x068d, (int16_t)0x01bb, (int16_t)0x0c10, (int16_t)0x0457, (int16_t)0x0957,
     (int16_t)0x0aaa, (int16_t)0x09ae, (int16_t)0x07d3, (int16_t)0x0257, (int16_t)0x092b, (int16_t)0x0403, (int16_t)0x092c, (int16_t)0x08c5, (int16_t)0x0260, (int16_t)0x0b3e, (int16_t)0x0176, (int16_t)0x00c0, (int16_t)0x0197, (int16_t)0x0c51, (int16_t)0x0895,
     (int16_t)0x01df, (int16_t)0x0c65, (int16_t)0x05c2, (int16_t)0x0c39, (int16_t)0x088c, (int16_t)0x0957, (int16_t)0x049b, (int16_t)0x0ae5, (int16_t)0x0891, (int16_t)0x0439, (int16_t)0x054f, (int16_t)0x098a, (int16_t)0x0591, (int16_t)0x04df, (int16_t)0x064a,
     (int16_t)0x0b02, (int16_t)0x0bc0, (int16_t)0x09f5, (int16_t)0x0089, (int16_t)0x099a, (int16_t)0x005c, (int16_t)0x0c8c, (int16_t)0x010d, (int16_t)0x0a61, (int16_t)0x034a, (int16_t)0x0bc7, (int16_t)0x0168, (int16_t)0x0268, (int16_t)0x0318, (int16_t)0x07d9,
     (int16_t)0x0928, (int16_t)0x03ec, (int16_t)0x0062, (int16_t)0x0237, (int16_t)0x0921, (int16_t)0x0145, (int16_t)0x0be8, (int16_t)0x03a2, (int16_t)0x015a, (int16_t)0x0a84, (int16_t)0x06a1, (int16_t)0x0049, (int16_t)0x09ea, (int16_t)0x078d, (int16_t)0x0664,
     (int16_t)0x046a, (int16_t)0x0278, (int16_t)0x01c8, (int16_t)0x0bb1, (int16_t)0x0783, (int16_t)0x0459, (int16_t)0x0bc8, (int16_t)0x0ae3, (int16_t)0x0165, (int16_t)0x054b, (int16_t)0x06c6, (int16_t)0x03b4, (int16_t)0x0498, (int16_t)0x08b4, (int16_t)0x08c6,
     (int16_t)0x0ca3, (int16_t)0x06c1, (int16_t)0x04b0, (int16_t)0x0603, (int16_t)0x05f5, (int16_t)0x0429, (int16_t)0x0955, (int16_t)0x0ceb, (int16_t)0x0a09, (int16_t)0x0732, (int16_t)0x078f, (int16_t)0x0acf, (int16_t)0x04ab, (int16_t)0x07de, (int16_t)0x0a94,
     (int16_t)0x0706, (int16_t)0x09a3, (int16_t)0x0c45, (int16_t)0x0627, (int16_t)0x0831, (int16_t)0x0cec, (int16_t)0x0cb3, (int16_t)0x042f, (int16_t)0x07f9, (int16_t)0x05d1, (int16_t)0x0cd5, (int16_t)0x0380, (int16_t)0x0c32, (int16_t)0x0463, (int16_t)0x03b7,
     (int16_t)0x0951, (int16_t)0x04c1, (int16_t)0x0a31, (int16_t)0x00bd, (int16_t)0x0441, (int16_t)0x07b6, (int16_t)0x06d1, (int16_t)0x0ad5, (int16_t)0x0c08, (int16_t)0x0abe, (int16_t)0x0b6e, (int16_t)0x018d, (int16_t)0x0adc, (int16_t)0x0757, (int16_t)0x0abf,
     (int16_t)0x04c6, (int16_t)0x09a0, (int16_t)0x0c04, (int16_t)0x0a0b, (int16_t)0x0b6c, (int16_t)0x00c9, (int16_t)0x0595, (int16_t)0x06b4, (int16_t)0x0019, (int16_t)0x0a2f, (int16_t)0x02b8, (int16_t)0x0240, (int16_t)0x0612, (int16_t)0x03d4, (int16_t)0x0420,
     (int16_t)0x005e}

};

int16_t gTestKyber512[2][256] = {
  { (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0x3, (int16_t)0x1, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x3, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x2, (int16_t)0x0, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0x2, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x2, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x3, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x2, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x0, (int16_t)0x2, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x2, (int16_t)0x1, (int16_t)0x3, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x2, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0x3, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0xfffffffd, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x2, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x2, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x1, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x3, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0x2, (int16_t)0x2, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0x2, (int16_t)0x2, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0x2, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x2, (int16_t)0xfffffffe, (int16_t)0x2, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x2, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x0, (int16_t)0xfffffffe },
  { (int16_t)0x0, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x0, (int16_t)0xfffffffd, (int16_t)0x2, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x2, (int16_t)0x1, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x1, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x2, (int16_t)0x0, (int16_t)0x0, (int16_t)0x3, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x3, (int16_t)0xfffffffd, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xfffffffd, (int16_t)0x0, (int16_t)0x2, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0x2, (int16_t)0x0, (int16_t)0xfffffffd, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0xfffffffd, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0x3, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x1, (int16_t)0x0, (int16_t)0x2, (int16_t)0x0, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xfffffffd, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0xfffffffd, (int16_t)0x1, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x2, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0xfffffffe, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x2, (int16_t)0x1, (int16_t)0xfffffffe, (int16_t)0xfffffffd, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0x0, (int16_t)0x0, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0x1, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xffffffff, (int16_t)0xfffffffd, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0xfffffffe, (int16_t)0x1, (int16_t)0x1, (int16_t)0x0, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0xfffffffe, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0x0, (int16_t)0xffffffff, (int16_t)0x2, (int16_t)0x1, (int16_t)0xfffffffe}

};
int16_t gTestKyber512Ref[2][256] = {
  {(int16_t)0x19a, (int16_t)0xfffffaf9, (int16_t)0x105, (int16_t)0x1a1, (int16_t)0x636, (int16_t)0xfffffd94, (int16_t)0x205, (int16_t)0xfffffc7f, (int16_t)0x531, (int16_t)0xfffffd02, (int16_t)0x211, (int16_t)0xfffffce0, (int16_t)0x182, (int16_t)0xfffffd0e, (int16_t)0x96, (int16_t)0x71, (int16_t)0x666, (int16_t)0x2ab, (int16_t)0x518, (int16_t)0x478, (int16_t)0xffffffce, (int16_t)0x4cf, (int16_t)0x236, (int16_t)0xfffffd5f, (int16_t)0x1ad, (int16_t)0x4de, (int16_t)0xfffffa6a, (int16_t)0xfffffa85, (int16_t)0xf4, (int16_t)0x599, (int16_t)0x1b9, (int16_t)0xfffffd4b, (int16_t)0x276, (int16_t)0xfffffa6e, (int16_t)0xffffff2d, (int16_t)0xfffffb68, (int16_t)0xfffffd54, (int16_t)0x445, (int16_t)0xfffffd2f, (int16_t)0xfffffa98, (int16_t)0x125, (int16_t)0x5a8, (int16_t)0x1ee, (int16_t)0xfffffb94, (int16_t)0x3ac, (int16_t)0xfffffb60, (int16_t)0xfffffeda, (int16_t)0x192, (int16_t)0xfffffa6a, (int16_t)0x175, (int16_t)0xfffffec7, (int16_t)0xfffffb88, (int16_t)0x491, (int16_t)0xfffffe3a, (int16_t)0xfffffed9, (int16_t)0xfffffa33, (int16_t)0x64, (int16_t)0xfffffcc6, (int16_t)0xfffffb51, (int16_t)0xfffffea2, (int16_t)0x13d, (int16_t)0xfffff990, (int16_t)0x5a6, (int16_t)0x513, (int16_t)0xfffffeae, (int16_t)0x60, (int16_t)0xfffffd6c, (int16_t)0xfffff991, (int16_t)0x55d, (int16_t)0x32a, (int16_t)0xffffffb0, (int16_t)0xfffffcd5, (int16_t)0x30c, (int16_t)0x4c9, (int16_t)0xfffffe49, (int16_t)0x533, (int16_t)0xffffff76, (int16_t)0x11c, (int16_t)0xfffffe09, (int16_t)0x313, (int16_t)0x534, (int16_t)0x587, (int16_t)0x3c8, (int16_t)0x2a4, (int16_t)0xda, (int16_t)0xfffffe2b, (int16_t)0xffffffd6, (int16_t)0xfffffbf3, (int16_t)0x441, (int16_t)0xfc, (int16_t)0xfffffdc6, (int16_t)0x2c9, (int16_t)0xfffffd58, (int16_t)0x5ca, (int16_t)0xfffffca2, (int16_t)0xfffffb9a, (int16_t)0xfffffea9, (int16_t)0xfffffe42, (int16_t)0xffffff56, (int16_t)0xfffffca6, (int16_t)0xfffffaf7, (int16_t)0x5f0, (int16_t)0xe6, (int16_t)0xffffff54, (int16_t)0xfffffe32, (int16_t)0xfffffae8, (int16_t)0x200, (int16_t)0x62e, (int16_t)0xfffff9cb, (int16_t)0x555, (int16_t)0xfffffd17, (int16_t)0xcc, (int16_t)0x91, (int16_t)0xfffffde9, (int16_t)0xfffffe27, (int16_t)0xfffffe95, (int16_t)0x3b0, (int16_t)0x64, (int16_t)0xa5, (int16_t)0x67f, (int16_t)0xfffffc32, (int16_t)0xfffffb78, (int16_t)0xfffffd04, (int16_t)0xffffff2d, (int16_t)0xfffffcbe, (int16_t)0x95, (int16_t)0x59e, (int16_t)0xfffffa75, (int16_t)0x539, (int16_t)0xfffffe60, (int16_t)0xffffff19, (int16_t)0x5ea, (int16_t)0x2d8, (int16_t)0x63a, (int16_t)0xfffffaa2, (int16_t)0x3f2, (int16_t)0x14f, (int16_t)0x644, (int16_t)0x35, (int16_t)0x533, (int16_t)0xca, (int16_t)0xfffffbbd, (int16_t)0xfffffdf5, (int16_t)0xfffff9fb, (int16_t)0x16f, (int16_t)0x530, (int16_t)0xfffffd1f, (int16_t)0xed, (int16_t)0xf, (int16_t)0x4af, (int16_t)0xfffffd18, (int16_t)0xfffffef8, (int16_t)0xa7, (int16_t)0xfffffea2, (int16_t)0xfffffe57, (int16_t)0x31d, (int16_t)0xce, (int16_t)0xfffffa91, (int16_t)0x278, (int16_t)0xfffffcc8, (int16_t)0xfffffe10, (int16_t)0x12c, (int16_t)0xfffffd1f, (int16_t)0x22f, (int16_t)0xfffffa90, (int16_t)0xffffff95, (int16_t)0xfffff9cd, (int16_t)0x11c, (int16_t)0xfffffcd3, (int16_t)0x4fe, (int16_t)0x44d, (int16_t)0x332, (int16_t)0xa0, (int16_t)0xfffffbf0, (int16_t)0xfffffddd, (int16_t)0x4c, (int16_t)0x5ae, (int16_t)0xfffffaef, (int16_t)0xfffffbb5, (int16_t)0x4ab, (int16_t)0x4ab, (int16_t)0x65d, (int16_t)0xfffffc93, (int16_t)0x21b, (int16_t)0x136, (int16_t)0x330, (int16_t)0xfffffa02, (int16_t)0xffffffbc, (int16_t)0xffffff8a, (int16_t)0x654, (int16_t)0x65a, (int16_t)0x47a, (int16_t)0xfffff98c, (int16_t)0x5cb, (int16_t)0x642, (int16_t)0x581, (int16_t)0xffffffd4, (int16_t)0xfffffe52, (int16_t)0xffffff02, (int16_t)0x2bd, (int16_t)0xda, (int16_t)0xfffffe49, (int16_t)0xfffffd01, (int16_t)0xfffffccf, (int16_t)0xfffffd48, (int16_t)0xfffffd42, (int16_t)0x363, (int16_t)0x43d, (int16_t)0xfffff9a2, (int16_t)0xfffffe21, (int16_t)0xfffffc9c, (int16_t)0x123, (int16_t)0xffffffe8, (int16_t)0xffffff48, (int16_t)0xffffff00, (int16_t)0xfffffa67, (int16_t)0xfffffe09, (int16_t)0xffffff96, (int16_t)0xfffffa36, (int16_t)0xfffffa66, (int16_t)0x658, (int16_t)0x321, (int16_t)0x3be, (int16_t)0xfffffb44, (int16_t)0x28d, (int16_t)0x226, (int16_t)0xfffffc8e, (int16_t)0x589, (int16_t)0x132, (int16_t)0xfffffb00, (int16_t)0x5c7, (int16_t)0x63b, (int16_t)0x90, (int16_t)0x220, (int16_t)0x35c, (int16_t)0x1c5, (int16_t)0xfffff9c1, (int16_t)0xfffffd78, (int16_t)0x431, (int16_t)0x1a7, (int16_t)0x104, (int16_t)0x4c3, (int16_t)0xfffffd66, (int16_t)0xfffffc48, (int16_t)0x137, (int16_t)0x220, (int16_t)0x268, (int16_t)0xec, (int16_t)0xce, (int16_t)0x58a, (int16_t)0xfffffe10, (int16_t)0x1e6, (int16_t)0xffffff32, (int16_t)0xfffffa42, (int16_t)0x640, (int16_t)0xfffffdc5},
  {(int16_t)0xfffffbd5, (int16_t)0xfffff9d7, (int16_t)0x649, (int16_t)0x368, (int16_t)0xffffff04, (int16_t)0xfffff9e6, (int16_t)0x14c, (int16_t)0x467, (int16_t)0x150, (int16_t)0xfffffa66, (int16_t)0xfffffc0a, (int16_t)0xaf, (int16_t)0xfffffe7d, (int16_t)0x655, (int16_t)0x582, (int16_t)0xffffff8e, (int16_t)0xfffffd39, (int16_t)0xfffffbe9, (int16_t)0xfffffe23, (int16_t)0x1ae, (int16_t)0xfffffd7d, (int16_t)0x1b5, (int16_t)0xfffffa25, (int16_t)0x22f, (int16_t)0x16d, (int16_t)0xfffff9ee, (int16_t)0xfffffeeb, (int16_t)0x62f, (int16_t)0xfffff9ad, (int16_t)0x52f, (int16_t)0xfffffbf3, (int16_t)0xfffffd90, (int16_t)0xffffff0e, (int16_t)0xfffffbf7, (int16_t)0xfffffebc, (int16_t)0x575, (int16_t)0xfffffc00, (int16_t)0xfffffe3c, (int16_t)0xfffffd83, (int16_t)0x5bf, (int16_t)0x624, (int16_t)0xffffffb7, (int16_t)0x611, (int16_t)0x90, (int16_t)0xfffffc68, (int16_t)0x653, (int16_t)0x448, (int16_t)0xfffffc64, (int16_t)0xfffffb2f, (int16_t)0x293, (int16_t)0x4b6, (int16_t)0xfffffd52, (int16_t)0x19c, (int16_t)0x179, (int16_t)0xfffffdd8, (int16_t)0x401, (int16_t)0xfffffccc, (int16_t)0xfffffadb, (int16_t)0x28a, (int16_t)0x2fc, (int16_t)0xfffffa29, (int16_t)0xffffff7d, (int16_t)0xfffffbc0, (int16_t)0xfffffc5e, (int16_t)0xffffff19, (int16_t)0x133, (int16_t)0x41, (int16_t)0xfffffdb3, (int16_t)0xfffffe38, (int16_t)0x18f, (int16_t)0x611, (int16_t)0x19a, (int16_t)0xfffffdcf, (int16_t)0x40a, (int16_t)0xfffffc20, (int16_t)0x104, (int16_t)0xfffffd1a, (int16_t)0xfffffb09, (int16_t)0x15a, (int16_t)0xfffffc58, (int16_t)0xa3, (int16_t)0x64, (int16_t)0xfffffcee, (int16_t)0x2aa, (int16_t)0xd7, (int16_t)0x11b, (int16_t)0x15e, (int16_t)0xfffff9c6, (int16_t)0xd7, (int16_t)0xfffffe9a, (int16_t)0x5d9, (int16_t)0xfffffa44, (int16_t)0x51a, (int16_t)0xfffffe57, (int16_t)0xfffffaef, (int16_t)0xfffffc9d, (int16_t)0xfffffb19, (int16_t)0x48b, (int16_t)0xfffffdef, (int16_t)0xfffffa75, (int16_t)0x80, (int16_t)0x48a, (int16_t)0x5db, (int16_t)0xfffffc09, (int16_t)0xfffffeaf, (int16_t)0x613, (int16_t)0x1a9, (int16_t)0x637, (int16_t)0x3af, (int16_t)0x1fd, (int16_t)0x417, (int16_t)0xdb, (int16_t)0x5ab, (int16_t)0x1fd, (int16_t)0xfffffb73, (int16_t)0x495, (int16_t)0xffffff42, (int16_t)0x42c, (int16_t)0x581, (int16_t)0xfffffc96, (int16_t)0x3cc, (int16_t)0x587, (int16_t)0xfffffcba, (int16_t)0x51a, (int16_t)0xc0, (int16_t)0xfffff9f9, (int16_t)0x62d, (int16_t)0xc, (int16_t)0xfffffe11, (int16_t)0xfffffbb1, (int16_t)0xfffffee4, (int16_t)0xffffff1d, (int16_t)0xfffffdfb, (int16_t)0x593, (int16_t)0xfffffaa2, (int16_t)0xfffffe2f, (int16_t)0x654, (int16_t)0xfffffcf2, (int16_t)0x402, (int16_t)0x2f8, (int16_t)0x63b, (int16_t)0xfffffb53, (int16_t)0xfffffa13, (int16_t)0xfffffa58, (int16_t)0x40f, (int16_t)0xa9, (int16_t)0xfffffb5c, (int16_t)0x5b3, (int16_t)0x146, (int16_t)0x477, (int16_t)0xfffff9ab, (int16_t)0x3ec, (int16_t)0x5fe, (int16_t)0xfffffcc5, (int16_t)0xffffffc3, (int16_t)0xfffffedb, (int16_t)0xfffffca5, (int16_t)0x274, (int16_t)0x1d, (int16_t)0xfffffc69, (int16_t)0xfffffa4f, (int16_t)0x39e, (int16_t)0x471, (int16_t)0x293, (int16_t)0xfffffb21, (int16_t)0x68, (int16_t)0xfffffcfa, (int16_t)0xfffffcf7, (int16_t)0xfffff99c, (int16_t)0x183, (int16_t)0x480, (int16_t)0xfffffc81, (int16_t)0xfffffa47, (int16_t)0x545, (int16_t)0xfffffbed, (int16_t)0x451, (int16_t)0xfffffee2, (int16_t)0xf, (int16_t)0x381, (int16_t)0x2a, (int16_t)0x12d, (int16_t)0xfffffa4c, (int16_t)0xfffffdc2, (int16_t)0xfffffe5c, (int16_t)0xfffffa0e, (int16_t)0x563, (int16_t)0x530, (int16_t)0xfffffb75, (int16_t)0xffffff08, (int16_t)0x16b, (int16_t)0xce, (int16_t)0x332, (int16_t)0x177, (int16_t)0x328, (int16_t)0xfffffa37, (int16_t)0x494, (int16_t)0xfffffca5, (int16_t)0xffffffa7, (int16_t)0xfffffe70, (int16_t)0x5e3, (int16_t)0xffffff2e, (int16_t)0xae, (int16_t)0x28b, (int16_t)0x13a, (int16_t)0x570, (int16_t)0x352, (int16_t)0xfffffcd7, (int16_t)0xfffffa1b, (int16_t)0x407, (int16_t)0x26, (int16_t)0x18c, (int16_t)0xfffffd23, (int16_t)0x44e, (int16_t)0x311, (int16_t)0xfffffaa6, (int16_t)0xfffffeae, (int16_t)0xffffffed, (int16_t)0x7d, (int16_t)0x166, (int16_t)0xfffffdda, (int16_t)0x341, (int16_t)0x5eb, (int16_t)0x22e, (int16_t)0x604, (int16_t)0xfffff980, (int16_t)0xfffffd91, (int16_t)0x1ee, (int16_t)0x588, (int16_t)0x43b, (int16_t)0xfffff9b7, (int16_t)0xfffffc76, (int16_t)0x425, (int16_t)0xfffffbe2, (int16_t)0xfffffb76, (int16_t)0x1f9, (int16_t)0xfffff980, (int16_t)0xd, (int16_t)0xfffffe9b, (int16_t)0x5c2, (int16_t)0xfffffda1, (int16_t)0xffffff70, (int16_t)0xfffffeff, (int16_t)0x512, (int16_t)0x3d5, (int16_t)0x61a, (int16_t)0x170, (int16_t)0x510, (int16_t)0xfffffe04, (int16_t)0xfffffe9a, (int16_t)0x2ef, (int16_t)0x329, (int16_t)0xfffffa95, (int16_t)0x341, (int16_t)0xfffffad5, (int16_t)0xfffffff4, (int16_t)0xfffffd31 }
};



static int test_kyberDatas()
{
  polyvec_ntt((polyvec*)gTestKyber512);
  if (memcmp((uint8_t*)gTestKyber512, (uint8_t*)gTestKyber512Ref, 1024))
  {
    printf("ERROR keys\n");
  }
  return 0;
}



static int test_keys()
{
  uint8_t pk[CRYPTO_PUBLICKEYBYTES];
  uint8_t sk[CRYPTO_SECRETKEYBYTES];
  uint8_t ct[CRYPTO_CIPHERTEXTBYTES];
  uint8_t key_a[CRYPTO_BYTES];
  uint8_t key_b[CRYPTO_BYTES];

  //Alice generates a public key
  crypto_kem_keypair(pk, sk);

  //Bob derives a secret key and creates a response
  crypto_kem_enc(ct, key_b, pk);

  //Alice uses Bobs response to get her shared key
  crypto_kem_dec(key_a, ct, sk);

  if(memcmp(key_a, key_b, CRYPTO_BYTES)) {
    printf("ERROR keys\n");
    return 1;
  }

  return 0;
}

static int test_invalid_sk_a()
{
  uint8_t pk[CRYPTO_PUBLICKEYBYTES];
  uint8_t sk[CRYPTO_SECRETKEYBYTES];
  uint8_t ct[CRYPTO_CIPHERTEXTBYTES];
  uint8_t key_a[CRYPTO_BYTES];
  uint8_t key_b[CRYPTO_BYTES];

  //Alice generates a public key
  crypto_kem_keypair(pk, sk);

  //Bob derives a secret key and creates a response
  crypto_kem_enc(ct, key_b, pk);

  //Replace secret key with random values
  randombytes(sk, CRYPTO_SECRETKEYBYTES);

  //Alice uses Bobs response to get her shared key
  crypto_kem_dec(key_a, ct, sk);

  if(!memcmp(key_a, key_b, CRYPTO_BYTES)) {
    printf("ERROR invalid sk\n");
    return 1;
  }

  return 0;
}

static int test_invalid_ciphertext()
{
  uint8_t pk[CRYPTO_PUBLICKEYBYTES];
  uint8_t sk[CRYPTO_SECRETKEYBYTES];
  uint8_t ct[CRYPTO_CIPHERTEXTBYTES];
  uint8_t key_a[CRYPTO_BYTES];
  uint8_t key_b[CRYPTO_BYTES];
  uint8_t b;
  size_t pos;

  do {
    randombytes(&b, sizeof(uint8_t));
  } while(!b);
  randombytes((uint8_t *)&pos, sizeof(size_t));

  //Alice generates a public key
  crypto_kem_keypair(pk, sk);

  //Bob derives a secret key and creates a response
  crypto_kem_enc(ct, key_b, pk);

  //Change some byte in the ciphertext (i.e., encapsulated key)
  ct[pos % CRYPTO_CIPHERTEXTBYTES] ^= b;

  //Alice uses Bobs response to get her shared key
  crypto_kem_dec(key_a, ct, sk);

  if(!memcmp(key_a, key_b, CRYPTO_BYTES)) {
    printf("ERROR invalid ciphertext\n");
    return 1;
  }

  return 0;
}

int main(void)
{
  test_kyberDatas();

  unsigned int i;
  int r;

  for(i=0;i<NTESTS;i++) {
    r  = test_keys();
    r |= test_invalid_sk_a();
    r |= test_invalid_ciphertext();
    if(r)
      return 1;
  }

  printf("CRYPTO_SECRETKEYBYTES:  %d\n",CRYPTO_SECRETKEYBYTES);
  printf("CRYPTO_PUBLICKEYBYTES:  %d\n",CRYPTO_PUBLICKEYBYTES);
  printf("CRYPTO_CIPHERTEXTBYTES: %d\n",CRYPTO_CIPHERTEXTBYTES);

  return 0;
}
